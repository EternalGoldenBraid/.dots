#!/usr/bin/env bash
set -euo pipefail

palette_file="${1:-$HOME/.dotfiles/.config/theme/palette.json}"

generator="$HOME/.dotfiles/.config/theme/scripts/generate_theme.py"
if [[ ! -f "$generator" ]]; then
  echo "ERROR: generator not found: $generator" >&2
  exit 1
fi

python3 "$generator" "$palette_file"

if command -v tmux >/dev/null 2>&1; then
  if tmux list-sessions >/dev/null 2>&1; then
    tmux source-file "$HOME/.tmux.conf"
    echo "tmux config reloaded"
  else
    echo "tmux server not running; generated theme file only"
  fi
fi
